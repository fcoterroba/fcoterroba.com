---
title: "Proyecto Python avanzado: ¬øC√≥mo crear una librer√≠a y subirla a PyPi?"
description: "Aprende a crear una librer√≠a en Python desde cero y subirla a PyPi, el mayor indexador de paquetes de Python."
excerpt: "Aprende a crear una librer√≠a en Python desde cero y subirla a PyPi, el mayor indexador de paquetes de Python."
category: "programaci√≥n de software"
tags: ["python", "librer√≠a", "tutorial", "proyecto", "avanzado"]
author: "fcoterroba"
date: "2022-05-03"
readTime: "9 min"
featured: false
coverImage: "/blog/covers/pypi-post.jpg"
lang: "es"
---

Hola mundo üëãüèª mi nombre es Francisco, fcoterroba en Internet y hoy os vuelvo a traer un post de esos que os gusta, en el que hacemos un proyectito, esta vez bastante avanzado, en Python üêç.

Concretamente, vamos a, dada una idea ya encontrada, crear y programar una librer√≠a usando Python y posteriormente compartirla al mayor indexador de librer√≠as del lenguaje, la web PyPi.

Actualmente, junto al post sobre programar un [bot en Twitter](https://fcoterroba.com/proyecto-python-avanzado-como-hacer-bot-twitter-automatizarlo), me parece uno de los proyectos m√°s complicados no solo por el hecho de programar, sino porque hay que tener varios factores en cuenta. Factores que seguramente, si tienes las nociones m√°s avanzadas sobre el lenguaje, puedas realizar sin ning√∫n tipo de problemas.

A√∫n as√≠, si ves que este proyecto se te hace demasiado grande, recuerda que tienes [una categor√≠a entera](https://fcoterroba.com/category/python) en mi p√°gina web donde podr√°s ir proyecto a proyecto aprendiendo desde 0.

Antes de comenzar, aunque posteriormente te voy a explicar qu√© es, te recomiendo visitar un post que sub√≠ hace m√°s de un mes, en el que explico muchos de los t√©rminos inform√°ticos m√°s usados en nuestro d√≠a a d√≠a. Ya que, en este post, ver√°s palabras que probablemente no te suenen mucho. ü§Ø **[Puedes leer el post aqu√≠](https://fcoterroba.com/diccionario-tecnologico-informatico)**.

Tambi√©n quiero recordarte que hace unos meses sub√≠ un v√≠deo a mi canal de YouTube, muy interesante, enfocado en la dom√≥tica del hogar. Concretamente, conectamos, configuramos e instalamos una bombilla inteligente üí° con la que puedes cambiar el color de la misma, apagarla, encenderla y much√≠simo m√°s simplemente haciendo uso de tu tel√©fono m√≥vil y/o asistentes de voz c√≥mo Google, Alexa, etc√©tera. üëáüèª

<iframe src="https://www.youtube.com/embed/RiCPuDhFbwI" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen width="100%" height="315" frameborder="0"></iframe>

Por √∫ltimo antes de comenzar, quer√≠a comunicar que llevo unas semanas subiendo v√≠deos a TikTok. √öltimamente son de Eurovisi√≥n dado que ya queda poco para ello pero te dejo por aqu√≠ el √∫ltimo que hice a d√≠a de hoy sobre inform√°tica.

<blockquote class="tiktok-embed" cite="https://www.tiktok.com/@fcoterroba/video/7077605052181007622" data-video-id="7077605052181007622" style="max-width: 605px;min-width: 325px;">
  <section>
    <a target="_blank" title="@fcoterroba" href="https://www.tiktok.com/@fcoterroba" rel="noopener noreferrer">@fcoterroba</a> like para la parte 2#<a title="fyp" target="_blank" href="https://www.tiktok.com/tag/fyp" rel="noopener noreferrer">fyp </a>#<a title="parati" target="_blank" href="https://www.tiktok.com/tag/parati" rel="noopener noreferrer">parati </a>#<a title="informatica" target="_blank" href="https://www.tiktok.com/tag/informatica" rel="noopener noreferrer">informatica </a>#<a title="darkweb" target="_blank" href="https://www.tiktok.com/tag/darkweb" rel="noopener noreferrer">darkweb </a>#<a title="deepweb" target="_blank" href="https://www.tiktok.com/tag/deepweb" rel="noopener noreferrer">deepweb</a>
    <a target="_blank" title="‚ô¨ She Share Story (for Vlog) - Â±±Âè£Â§ï‰æù" href="https://www.tiktok.com/music/She-Share-Story-for-Vlog-6722656094272883458" rel="noopener noreferrer">‚ô¨ She Share Story (for Vlog) - Â±±Âè£Â§ï‰æù</a>
  </section>
</blockquote>
<script async src="https://www.tiktok.com/embed.js"></script>

**Antes de comenzar, ¬øqu√© es una librer√≠a o paquete en Python?**

Una librer√≠a o paquete en Python (y por ende en casi todo el resto de lenguajes de programaci√≥n que lo permiten) es un conjunto de implementos funcionales que te ayudan a programar.

Seg√∫n dijo David Zarruk, una librer√≠a de programaci√≥n es un conjunto de funciones que alguien escribi√≥ en alguna parte del mundo y ha disponibilizado para que cualquiera pueda utilizarlo de forma gratuita.

Me encanta esta definici√≥n porque creo que es un bonito gui√±o al software libre y a la programaci√≥n en general. Llegar mediante c√≥digo a cualquier otra parte del planeta.ü§©

**1Ô∏è‚É£ PRIMER PASO 1Ô∏è‚É£**

**Tener la idea.**

Antes de empezar a programar en s√≠, necesitamos tener la idea de nuestra librer√≠a.

Bien es cierto que podemos simplemente crear una librer√≠a que te devuelva Hola Mundo pero intenta sacarle un poco de ingenio y, por ejemplo, devuelve un string en binario.

En mi caso, lo que voy a hacer es un generador aleatorio de nombres Espa√±oles.

**2Ô∏è‚É£ SEGUNDO PASO 2Ô∏è‚É£**

**Obtener todo lo necesario**

Si por ejemplo vas a devolver un string en binario no necesitas nada m√°s y puedes pasar directamente al tercer paso, pero en mi caso, necesito datos y fuentes oficiales.

Para m√≠ caso, necesitaba descargar un csv con toda la informaci√≥n sobre nombres y apellidos Espa√±oles y encontr√© este fantastico repositorio de [Marc Boquet](https://github.com/marcboquet/spanish-names)

Entonces, clon√© el repositorio y me qued√© con los tres CSV principales, el de nombres de hombre, el de nombres de mujer y el de los apellidos

**3Ô∏è‚É£ TERCER PASO 3Ô∏è‚É£**

**Empecemos a programar**

Ahora que tengamos todo lo necesario, creamos nuestro directorio, lo abrimos con VSCode y vamos a importar los archivos necesarios en caso de necesitarlos.

No voy a ser muy explicativo en este proyecto ya que no va de c√≥mo hice este librer√≠a sino de c√≥mo hacer la tuya propia, pero a√∫n as√≠, vayamos poco a poco:

Lo primero que hice fue instalar la √∫nica librer√≠a que necesitaba para trabajar f√°cilmente con archivos CSV: Pandas.

```
pip3 install pandas
```

A continuaci√≥n simplemente quise devolver un nombre aleatorio del csv de hombres, por ejemplo.

```python
name = pd.read_csv("hombres.csv")
temporal_return = name.sample()["nombre"].to_string(index=False).strip()
print(temporal_return)

# Te devuelve un string as√≠:
# BRYAN ANTHONY
```

Al igual que hice con el de mujer y el de los apellidos.

Luego, ric√© un poco m√°s el rizo y quise dar un poco m√°s de libertad al usuario que instalase la librer√≠a dandole la posibilidad de solicitar tantos nombres como quisiera.

Para ello ten√≠a que a√±adirle un par√°metro **CON DEFAULT** a la funci√≥n y modificar un poco el contenido de la misma

```python
def testing(numberNames=1):
    name = pd.read_csv("hombres.csv")
    if numberNames >= 2:
        result_array = []
        for i in range(numberNames):
            temporal_return = name.sample()["nombre"].to_string(index=False).strip()
            result_array.append(temporal_return)
        return result_array
    else:
        result_string = name.sample()["nombre"].to_string(index=False).strip()
        return result_string

print(testing(5))
# Te devuelve un array de este estilo:
# ['FEDERICO JOAQUIN', 'QUNWEI', 'DAVID MANUEL', 'PEDRO BASILIO', 'JAVIER ANIBAL']
```

Ahora, lo √∫ltimo que se me ocurri√≥ que pod√≠a llegar a ser frecuente en los usos probables de la librer√≠a es la solicitud de **NOMBRES COMLETOS,** es decir, que el usuario solicite 1 o m√°s nombres pero con sus respectivos apellidos, as√≠ fue c√≥mo qued√≥ esto:

```python
def getRandomMaleName(numberNames=1, fullName=False):
    name = pd.read_csv("hombres.csv")
    if numberNames >= 2:
        result_array = []
        surname = pd.read_csv("apellidos.csv")
        for i in range(numberNames):
            temporal_return = name.sample()["nombre"].to_string(index=False).strip()
            if fullName:
                temporal_return += " "
                temporal_return += surname.sample()["apellido"].to_string(index=False)
                temporal_return += " "
                temporal_return += surname.sample()["apellido"].to_string(index=False)
            result_array.append(temporal_return)
        return result_array
    else:
        result_string = name.sample()["nombre"].to_string(index=False).strip()
        return result_string

print(getRandomMaleName(2, True))
# Esto nos devuelve un array de dos strings con nombres completos
# ['JUAN BENIGNO PASQUAL MORAGREGA', 'ADRIAN ENRIQUE CEDE√ëO KENT']
```

Para los nombres de mujer aplica exactamente igual pero claro, qu√© par√°metros podemos a√±adir a la hora de solicitar solo apellidos?

Pues, al igual que antes, cu√°ntos apellidos quiere y si quiere apellidos individuales o A PARES.

```python
def getRandomSurname(numberSurnames=1, pairs=False):
    surname = pd.read_csv("apellidos.csv")
    if numberSurnames >= 2:
        result_array = []
        tmp = ""
        for i in range(numberSurnames):
            if pairs:
                tmp = surname.sample()["apellido"].to_string(index=False)
            result_array.append(surname.sample()["apellido"].to_string(index=False)  + " " + tmp)
        return result_array
    else:
        tmp = ""
        if pairs:
            tmp = surname.sample()["apellido"].to_string(index=False)
        return f"{surname.sample()['apellido'].to_string(index=False) + ' ' + tmp}"

print(getRandomSurname(4, True))
# Esto nos devuelve un array de strings con pares de apellidos
# ['AINOZA LAFORET', 'SAID JUAREZ', 'ALFARO RAHHOU', 'LLADOSA CAPOTE']
```

**4Ô∏è‚É£ CUARTO PASO 4Ô∏è‚É£**

Una vez que ya tenemos nuestro script funcionando y lo hemos testeado correctamente, vamos a empezar con el proceso de subida a pypi.

Pero antes de subirla necesitamos tener nuestro directorio del proyecto correctamente distribuido.

Primeramente, necesitamos el archivo **__init__.py** que ser√° la forma en la que indicamos c√≥mo podemos invocar nuestras funciones.

Es posible dejarlo vac√≠o aunque para el usuario ser√≠a m√°s complicado ya que deber√≠a importarla en su proyecto as√≠:

```
from carpeta.archivo import funci√≥n
```

Para hacerlo m√°s elegante tendremos que indicar la **RUTA RELATIVA** as√≠ c√≥mo escribir una l√≠nea por funci√≥n. En nuestro caso:

```
from .functions import getRandomMaleName
from .functions import getRandomFemaleName
from .functions import getRandomSurname
```

A continuaci√≥n necesitamos el archivo de **setup.py** que, sigue una plantilla est√°ndar y no es nada complejo. Aqu√≠ os dejo la plantilla vac√≠a:

```python
import pathlib
from setuptools import find_packages, setup

HERE = pathlib.Path(__file__).parent

VERSION = 'X.X'
PACKAGE_NAME = 'EL NOMBRE DE TU PAQUETE'
AUTHOR = 'AUTOR'
AUTHOR_EMAIL = 'TU@EMAIL.COM'
URL = 'WWW.TUPAGINAWEB.ES'

LICENSE = 'TIPO DE LICENCIA'
DESCRIPTION = 'DESCRIPCI√ìN CORTA EXPLICANDO LA LIBRER√çA'

#Paquetes necesarios para que funcione la libre√≠a. Se instalar√°n a la vez si no lo tuvieras ya instalado
INSTALL_REQUIRES = [
    'pandas'
]

setup(
    name=PACKAGE_NAME,
    version=VERSION,
    description=DESCRIPTION,
    author=AUTHOR,
    author_email=AUTHOR_EMAIL,
    url=URL,
    install_requires=INSTALL_REQUIRES,
    license=LICENSE,
    packages=find_packages(),
    include_package_data=True
)
```

Una vez que tengamos todo esto lo distribuimos as√≠:

![Estructura del proyecto](/blog/covers/proyecto-python-fastapi.jpg)

Una carpeta BASE que contenga el setup y una carpeta que contenga el init y nuestro archivo de funciones

**5Ô∏è‚É£ QUINTO PASO 5Ô∏è‚É£**

Ya nos acercamos al final pero previamente necesitaremos **EMPAQUETAR** la librer√≠a y crear los ficheros de distribuci√≥n.

Para ello ejecutamos el setup.py que hemos creado de la siguiente manera:

```
python3 setup.py sdist bdist_wheel
```

Esto nos crear√° una carpeta llamada *dist* que contendr√° la librer√≠a en formato **.tar.gz** y en **.whl**

**6Ô∏è‚É£ SEXTO PASO 6Ô∏è‚É£**

Ahora s√≠ que s√≠, vamos a proceder a subir nuestra librer√≠a al indexador pypi.

Para ello, lo primero es instalar la librer√≠a de twine con:

```
pip3 install twine
```

![Instalaci√≥n de twine](/blog/covers/proyecto-python-fastapi.jpg)

Una vez instalado subimos los dos formatos generados y listo!

```
twine upload dist/TUARCHIVO.tar.gz dist/TUARCHIVO-py3-none-any.whl
```

Una vez hecho te pedir√° usuario y contrase√±a de tu perfil en Pypi y listo, ya habr√°s creado tu primera librer√≠a!

Puedes entrar al repositorio de mi librer√≠a en [GitHub](https://github.com/fcoterroba/random_spanish) e incluso verla en [pypi](https://pypi.org/project/random-spanish/)!

üèÅ **Fin del post** üèÅ

Y esto ha sido todo por hoy. Gracias por llegar hasta el final, espero que os haya servido y gustado. Nos vemos pronto!

Pod√©is contribuir econ√≥micamente mediante [Paypal](https://www.paypal.com/paypalme/fcoterroba). Toda cantidad es bien recibida! üôÇ

Espero tambi√©n que teng√°is una genial semana y nos vemos por aqu√≠ dentro de poquito! Un saludo y recuerda seguirme en las redes como [Twitter](https://twitter.com/fcoterroba), [Facebook](https://www.facebook.com/fcoterroba), [Instagram](https://www.instagram.com/fcoterroba/), [GitHub](https://www.github.com/fcoterroba), [LinkedIn](https://www.linkedin.com/in/fcoterroba/) y ahora tambi√©n en [TikTok](https://us.tiktok.com/@fcoterroba). ü§üüèª

**Fuentes:** [crehana.com](https://www.crehana.com/es/blog/desarrollo-web/librerias-python/), [antonio-fernandez-troyano.medium.com](https://antonio-fernandez-troyano.medium.com/crear-una-libreria-python-4e841fbd154f)

