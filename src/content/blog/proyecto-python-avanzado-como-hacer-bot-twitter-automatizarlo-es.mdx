---
title: "Proyecto Python avanzado: ¬øC√≥mo hacer un bot en Twitter y automatizarlo?"
description: "Aprende a crear un bot de Twitter con Python usando Tweepy, desde solicitar las API keys hasta automatizarlo con crontab en un servidor."
excerpt: "Aprende a crear un bot de Twitter con Python usando Tweepy, desde solicitar las API keys hasta automatizarlo con crontab en un servidor."
category: "programaci√≥n de software"
tags: ["python", "twitter", "bot", "tweepy", "automatizaci√≥n", "api", "tutorial"]
author: "fcoterroba"
date: "2020-12-14"
readTime: "15 min read"
featured: false
coverImage: "/blog/covers/twitter-bot-python.jpg"
lang: "es"
---

Hola mundo üëãüèª mi nombre es Francisco, fcoterroba en Internet y hoy os vuelvo a traer un post de esos que os gusta, en el que hacemos un proyectito, esta vez bastante avanzado, en Python üêç.
Concretamente, vamos a programar un bot en Twitter, explicando c√≥mo solicitar las keys, c√≥mo empezar a programarlo, qu√© funciones se le puede dar, c√≥mo hacer un deploy correctamente, qu√© librer√≠as necesitamos, etc√©tera

Este proyecto es, **bajo mi punto de vista**, el proyecto m√°s complicado que he realizado hasta la fecha en la p√°gina por lo que, aunque s√© que te interesa mucho esta parte, te recomiendo visitar antes todos mis proyectos de Python, que poseen un nivel algo inferior a este y puedes as√≠, asentar conceptos de manera correcta! ‚úÖ

Por orden, yo te recomiendo mi post sobre [¬øC√≥mo hacer una calculadora en la consola de comandos?](https://fcoterroba.com/proyecto-python-principiantes-calculadora), el proyecto que hicimos [para generar c√≥digos QR.](https://fcoterroba.com/proyecto-python-principiantes-generar-codigo-qr)
Pasamos despu√©s a un proyecto en el que, usando [APIs p√∫blicas y gratuitas, fuimos capaces de conseguir un exchange de monedas con interfaz gr√°fica.](https://fcoterroba.com/proyecto-python-medio-exchange-interfaz-grafica)
Por √∫ltimo, te recomiendo el √∫ltimo post que he subido hasta la fecha, en el que hicimos un [acortador de enlaces con interfaz gr√°fica donde puedes abrir y copiar autom√°ticamente los enlaces generados](https://fcoterroba.com/proyecto-python-medio-hacer-acortador-enlaces-interfaz-grafica).

Antes de comenzar, aunque posteriormente te voy a explicar qu√© es, te recomiendo visitar un post que sub√≠ hace m√°s de un mes, en el que explico muchos de los t√©rminos inform√°ticos m√°s usados en nuestro d√≠a a d√≠a. Ya que, en este post, ver√°s palabras que probablemente no te suenen mucho. ü§Ø **[Puedes leer el post aqu√≠](https://fcoterroba.com/diccionario-tecnologico-informatico)**.

Tambi√©n quiero recordarte que hace unos meses sub√≠ un v√≠deo a mi canal de YouTube, muy interesante, enfocado en la dom√≥tica del hogar. Concretamente, conectamos, configuramos e instalamos una bombilla inteligente üí° con la que puedes cambiar el color de la misma, apagarla, encenderla y much√≠simo m√°s simplemente haciendo uso de tu tel√©fono m√≥vil y/o asistentes de voz c√≥mo Google, Alexa, etc√©tera. üëáüèª

<iframe src="https://www.youtube.com/embed/RiCPuDhFbwI" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen width="100%" height="315" frameborder="0"></iframe>

Ahora s√≠ que s√≠, comencemos üëáüèª

**¬øQu√© es un bot de Twitter?**

Seg√∫n wikipedia, un bot de Twitter o Twitterbot es un software que controla una cuenta de Twitter a trav√©s de la API oficial de estos.

Por lo general, el bot podr√° tuitear, retuitear, dar likes, seguir, dejar de seguir, etc√©tera.

En resumen, un bot de Twitter suele ser una cuenta o perfil de usuario donde todas, o casi todas las acciones est√°n automatizadas por un programa o script.

**¬øQu√© vamos a hacer?**

Pues, voy a aprovechar el post para explicar c√≥mo se programa un bot en Twitter pero quiero hacer algo que ya ten√≠a en mente hace unos meses, cuando vi que la gente en Twitter le gusta jugar a peque√±os juegos del estilo RT o FAV si eres m√°s alto que X (sustituyendo X por el personaje famoso de turno). **Ejemplo:**

<iframe border="0" frameborder="0" height="500" width="100%" src="https://twitframe.com/show?url=https://twitter.com/comradenyan/status/1333972341966184450"></iframe>

Una vez definido nuestro objetivo, comenzamos.

**1Ô∏è‚É£ PRIMER PASO 1Ô∏è‚É£**

Para trabajar con la API de Twitter necesitamos crear una cuenta de Twitter (si no tenemos ya una o queremos que nuestro bot tenga cuenta propia, c√≥mo es lo normal) y posteriormente registrarnos en la [p√°gina de Twitter para desarrolladores](https://developer.twitter.com/en) (solo est√° en Ingl√©s)

Simplemente tendremos que dar click en **Apply,** arriba a la derecha y rellenar el formulario indicando para qu√© queremos el acceso a la API de Twitter.

Una vez que lo rellenemos, llegaremos a esta p√°gina y solo nos quedar√° estar pendientes del correo electr√≥nico (tarda, como mucho, dos d√≠as) en el que nos dar√°n el OK o bien nos har√°n m√°s preguntas sobre nuestro desarrollo con dicha API

![Twitter Developer Portal](/blog/covers/wordpress_to_astro_ES.jpg)

**2Ô∏è‚É£ SEGUNDO PASO 2Ô∏è‚É£**

Una vez que nos hayan dado el acceso a la API (mirar el correo incluyendo la bandeja de spam), vamos a crear **un proyecto** al cual le daremos un nombre, una descripci√≥n y en general, rellenar toda la informaci√≥n que se nos pide.

![Crear proyecto en Twitter](/blog/covers/wordpress_to_astro_ES.jpg)

**3Ô∏è‚É£ TERCER PASO 3Ô∏è‚É£**

Vamos a empezar ahora con la programaci√≥n.
Como ya he dicho antes, este proyecto lo quiero orientar a un bot que twittea una vez al d√≠a a modo de encuesta publicando la altura de un personaje famoso, el nombre del susodicho y una imagen del mismo.

Para ello, quiero englobar todo el dataset en un archivo **json.**

Las im√°genes las coger√© de un sitio web estable como wikipedia.

Nos quedar√≠a algo as√≠:

```json
[
    {
        "appear": "False",
        "name": "Shrek",
        "height": "2.13 m",
        "img": "https://vignette.wikia.nocookie.net/shrekogro/images/9/98/Shrek.png/revision/latest?cb=20161204164724&path-prefix=es"
    },
    ...
    {
      	"appear": "False",
        "name": "Felipe VI",
        "height": "1.97 m",
        "img": "https://www.aboutespanol.com/thmb/ADj-DP6ByR_omi2FnIMReJHgnus=/768x0/filters:no_upscale():max_bytes(150000):strip_icc()/SAR_Principe_1024_px-597b9eeb3df78cbb7a257605.jpg"
    }
]
```

Es simplemente el nombre del personaje, la altura, una imagen con su enlace de internet y una propiedad llamada **appear** (aparecer en Ingl√©s) que por defecto estar√° en falso pero que modificaremos posteriormente en Python.

**4Ô∏è‚É£ CUARTO PASO 4Ô∏è‚É£**

Ahora s√≠ que s√≠, vamos con el c√≥digo de python:

Lo primero que tenemos que hacer es instalar, con **pip**, el paquete necesario para twittear.

`pip install tweepy`

![Instalar tweepy](/blog/covers/wordpress_to_astro_ES.jpg)

Posteriormente y de manera resumida, vamos a importar la librer√≠a, creamos un objeto con nuestras credenciales (API keys) y usamos el m√©todo `update_status` para publicar un tweet.

```python
import tweepy
import json
import random
import requests
import os

# Abrimos el archivo json
with open('characters.json') as f:
  data = json.load(f)

# Nos autenticamos en Twitter
auth = tweepy.OAuthHandler("ESCRIBE TUS CREDENCIALES", "ESCRIBE TUS CREDENCIALES")
auth.set_access_token("ESCRIBE TUS CREDENCIALES", "ESCRIBE TUS CREDENCIALES")

# Creamos un objeto de la librer√≠a
api = tweepy.API(auth)

# Generamos un valor aleatorio para elegir el personaje del JSON
# Y posteriormente cambiamos el valor de su aparici√≥n para que
# No vuelva a salir
character = 0
while data[character]['appear'] == "True":
  character = int(random.uniform(0,len(data)))
  if data[character]['appear'] == "False":
    data[character]['appear'] = "True"
    break
    
# Abrimos el archivo json con permisos para escritura
with open('characters.json', 'w') as f:
  f.write(json.dumps(data, sort_keys=True, indent=4, separators=(',',': ')))
  
# Creamos una variable para transformar metros a pies (medida com√∫nmente
# usada en EEUU)
height_in_foot = round(float(data[character]['height'][0:4]) * 3.281, 3)

# Guardamos el mensaje final
msg = f"RT si mides m√°s que {data[character]['name']} --> {data[character]['height']}\n\nRT if you're taller than {data[character]['name']} --> {height_in_foot} ft"

# Descargamos y borramos la imagen del enlace autom√°ticamente
filename = "temp.jpg"
request = requests.get(data[character]['img'], stream=True)
if request.status_code == 200:
  with open(filename, 'wb') as image:
    for chunk in request:
      image.write(chunk)
      
# Tuiteamos el resultado final pas√°ndole el par√°metro de mensaje y la imagen.
api.update_with_media(filename, msg)

# Borramos la imagen al final de la ejecuci√≥n
os.remove('temp.jpg')
```

Y con esto ya tendr√≠amos nuestro scrip listo! ü§ì

Es as√≠, si queremos, podemos ejecutar el script siempre que queramos para twittear cuando queramos pero, la gracia est√° en automatizar este proceso, cierto? üòâ

**5Ô∏è‚É£ QUINTO PASO 5Ô∏è‚É£**

Recientemente he obtenido un VPS al que le he instalado la √∫ltima versi√≥n de Debian 10 as√≠ que, trabajaremos bajo este sistema.

Existe una herramienta en Linux llamada **crontab** que sirve √∫nica y exclusivamente para realizar ciertos scripts o acciones a un determinado momento del d√≠a.

Su configuraci√≥n es sencilla, simplemente deberemos escribir el siguiente comando en la terminal:

`crontab -e`

Se nos abrir√° entonces nuestro editor de texto con una informaci√≥n en ingl√©s.

Pero, resumidamente y con un ejemplo, si quieres que este script, como hago yo, se ejecute a diario, a las 18:00 de la tarde, deber√°s escribir lo siguiente, al final del archivo:

`00 18 * * * cd /ruta/donde/est√©/el_script && /ruta/de/python archivo.py`

Guardamos con **CTRL + O** y salimos con **CTRL + X**

![Configuraci√≥n de crontab](/blog/covers/wordpress_to_astro_ES.jpg)

---

Pod√©is ver el resultado final y ya que est√°is, seguir al bot en [su Twitter oficial](https://twitter.com/rt_or_fav_you) ü§ñ

Y poco m√°s que a√±adir chic@s, espero que os haya gustado much√≠simo ya que a m√≠ me ha encantado programarlo y explicarlo! Espero tambi√©n que teng√°is una genial semana y nos vemos por aqu√≠ dentro de poquito! Un saludo y recuerda seguirme en las redes como [Twitter](https://twitter.com/fcoterroba), [Facebook](https://www.facebook.com/fcoterroba), [Instagram](https://www.instagram.com/fcoterroba/) y [LinkedIn](https://www.linkedin.com/in/fcoterroba/). ü§üüèª

